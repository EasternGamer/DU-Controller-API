function Controller(a,b,c)local self={}if a==nil then a=true end;if a then b=false;c=false end;if b==nil then b=false end;if c==nil then c=true end;local construct,system=construct,system;local d=construct.getWorldVelocity;local e=system.getAxisValue;local f=construct.getMass;local g=construct.getMaxBrake;local h=system.getArkTime;local function i()if c then return(e(3)+1)*0.5 else local j=e(3)if not a then return j else if j<0 then return 0 else return j end end end end;local function k()if b then return(e(4)+1)*0.5 elseif a then local j=-e(3)if j>0 then return j else return 0 end end;return 0 end;function self.getRawRoll()return e(0)end;function self.getRawPitch()return e(1)end;function self.getRawYaw()return e(2)end;function self.getRawThrottle()return i()end;function self.getRawBrake()return k()end;function self.getRawStrafe()return e(5)end;function self.getRawVertical()return e(6)end;function self.getRawAxis7()return e(7)end;function self.getRawAxis8()return e(8)end;function self.getRawAxis9()return e(9)end;local l={0,0,0,0.05,0,0,0,0,0}local m={self.getRawRoll(),self.getRawPitch(),self.getRawYaw(),self.getRawThrottle(),self.getRawBrake(),self.getRawStrafe(),self.getRawVertical(),self.getRawAxis7(),self.getRawAxis8(),self.getRawAxis9()}local n={0,0,0,0,0,0,0,0,0,0}local function o(p,q)if q>=1 then deadzone[p]=0.999 elseif q<=0 then deadzone[p]=0 else deadzone[p]=q end end;function self.setRollDeadzone(r)o(0,r)end;function self.setPitchDeadzone(r)o(1,r)end;function self.setYawDeadzone(r)o(2,r)end;function self.setThrottleDeadzone(r)o(3,r)end;function self.setBrakeDeadzone(r)o(4,r)end;function self.setStafeDeadzone(r)o(5,r)end;function self.setVerticalDeadzone(r)o(6,r)end;function self.setAxis7Deadzone(r)o(7,r)end;function self.setAxis8Deadzone(r)o(8,r)end;function self.setAxis9Deadzone(r)o(9,r)end;local function s(q,deadzone)if q<0 then return q<-deadzone and(q+deadzone)*1/(1-deadzone)or 0 else return q>deadzone and(q-deadzone)*1/(1-deadzone)or 0 end end;local function t(q,deadzone)q=q*1/(1-deadzone)if q<0 then return q>-1 and q or-1 else return q<1 and q or 1 end end;local function u(q,deadzone)if c then return t(q,deadzone)else local v=s(q,deadzone)local w=t(v,deadzone)return w end end;local function x(y)y=y+1;local z=h()if z-n[y]>1/65 then n[y]=z;local A=e(y-1)local B=m[y]-A;if B<0.8 and B>-0.8 then newInput=s(A,l[y])m[y]=newInput;return newInput else return m[y]end else return m[y]end end;function self.getRollInput()return x(0)end;function self.getPitchInput()return x(1)end;function self.getYawInput()return x(2)end;function self.getThrottleInput()local z=h()if z-n[4]>1/65 then n[4]=z;local j=i()local B=j-m[4]if B<0.8 and B>-0.8 then j=u(j,l[4])m[4]=j;return j else return m[4]end else return m[4]end end;function self.getBrakeInput()local z=h()if z-n[5]>1/65 then n[5]=z;local C=k()local B=C-m[5]if B<0.8 and B>-0.8 then C=u(C,l[5])m[5]=C;return C else return m[5]end else return m[5]end end;function self.getStafeInput()return x(5)end;function self.getVerticalInput()return x(6)end;function self.getAxis7Input()return x(7)end;function self.getAxis8Input()return x(8)end;function self.getAxis9Input()return x(9)end;function self.getBrakeVectorUnpacked()local D=d()local E,F,G=D[1],D[2],D[3]local H=(E*E+F*F+G*G)^0.5;local I=g()/f()local J=-self.getBrakeInput()*I;return J*E/H,J*F/H,J*G/H end;function self.getBrakeVector()return{self.getBrakeVectorUnpacked()}end;return self end
